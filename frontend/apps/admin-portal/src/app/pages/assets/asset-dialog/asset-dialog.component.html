<p-dialog
  [(visible)]="visible"
  [header]="getDialogHeader()"
  [modal]="true"
  [style]="{ width: '700px' }"
  [draggable]="false"
  [resizable]="false"
  (onHide)="onClose()"
  styleClass="dialog-modern">

  <form [formGroup]="assetForm" (ngSubmit)="onSave()">
    <div class="p-fluid">
      <div class="formgrid grid">
        <div class="field col-6">
          <label for="code">{{ 'assets.assetCode' | translate }} <span class="p-error">*</span></label>
          <input
            pInputText
            id="code"
            formControlName="code"
            [class.ng-invalid]="assetForm.get('code')?.invalid && assetForm.get('code')?.touched" />
          <small class="p-error" *ngIf="assetForm.get('code')?.invalid && assetForm.get('code')?.touched">
            {{ 'validation.required' | translate }}
          </small>
        </div>

        <div class="field col-6">
          <label for="name">{{ 'assets.assetName' | translate }} <span class="p-error">*</span></label>
          <input
            pInputText
            id="name"
            formControlName="name"
            [class.ng-invalid]="assetForm.get('name')?.invalid && assetForm.get('name')?.touched" />
          <small class="p-error" *ngIf="assetForm.get('name')?.invalid && assetForm.get('name')?.touched">
            {{ 'validation.required' | translate }}
          </small>
        </div>
      </div>

      <div class="formgrid grid">
        <div class="field col-6">
          <label for="categoryId">{{ 'assets.category' | translate }} <span class="p-error">*</span></label>
          <p-dropdown
            id="categoryId"
            formControlName="categoryId"
            [options]="categories()"
            optionLabel="label"
            optionValue="value"
            [showClear]="true"
            [placeholder]="'assets.selectCategory' | translate"
            styleClass="w-full">
          </p-dropdown>
          <small class="p-error" *ngIf="assetForm.get('categoryId')?.invalid && assetForm.get('categoryId')?.touched">
            {{ 'validation.required' | translate }}
          </small>
        </div>

        <div class="field col-6" *ngIf="mode === 'edit'">
          <label for="status">{{ 'common.status' | translate }} <span class="p-error">*</span></label>
          <p-dropdown
            id="status"
            formControlName="status"
            [options]="assetStatusOptions"
            optionLabel="label"
            optionValue="value"
            [placeholder]="'common.selectStatus' | translate"
            styleClass="w-full">
          </p-dropdown>
        </div>
      </div>

      <div class="formgrid grid">
        <div class="field col-6">
          <label for="manufacturer">{{ 'assets.manufacturer' | translate }}</label>
          <input
            pInputText
            id="manufacturer"
            formControlName="manufacturer" />
        </div>

        <div class="field col-6">
          <label for="serialNumber">{{ 'assets.serialNumber' | translate }}</label>
          <input
            pInputText
            id="serialNumber"
            formControlName="serialNumber" />
        </div>
      </div>

      <div class="formgrid grid">
        <div class="field col-6">
          <label for="purchasePrice">{{ 'assets.purchasePrice' | translate }} (VND) <span class="p-error">*</span></label>
          <p-inputNumber
            id="purchasePrice"
            formControlName="purchasePrice"
            mode="currency"
            currency="VND"
            locale="vi-VN"
            [minFractionDigits]="0"
            [maxFractionDigits]="0">
          </p-inputNumber>
        </div>

        <div class="field col-6">
          <label for="purchaseDate">{{ 'assets.purchaseDate' | translate }} <span class="p-error">*</span></label>
          <p-calendar
            id="purchaseDate"
            formControlName="purchaseDate"
            [showIcon]="true"
            dateFormat="dd/mm/yy"
            styleClass="w-full">
          </p-calendar>
        </div>
      </div>

      <div class="formgrid grid">
        <div class="field col-6">
          <label for="depreciationRate">{{ 'assets.depreciationRate' | translate }} (%) <span class="p-error">*</span></label>
          <p-inputNumber
            id="depreciationRate"
            formControlName="depreciationRate"
            [min]="0"
            [max]="100"
            suffix="%">
          </p-inputNumber>
        </div>

        <div class="field col-6">
          <label for="location">{{ 'assets.location' | translate }}</label>
          <input
            pInputText
            id="location"
            formControlName="location" />
        </div>
      </div>

      <div class="field" *ngIf="mode === 'edit'">
        <label for="isActive">{{ 'common.status' | translate }}</label>
        <p-dropdown
          id="isActive"
          formControlName="isActive"
          [options]="activeStatusOptions"
          optionLabel="label"
          optionValue="value"
          [placeholder]="'common.selectStatus' | translate"
          styleClass="w-full">
        </p-dropdown>
      </div>
    </div>

    <div class="flex justify-content-end gap-2 mt-4 pt-3 border-top-1 surface-border">
      <button
        pButton
        type="button"
        [label]="'common.cancel' | translate"
        class="p-button-outlined p-button-secondary"
        icon="pi pi-times"
        (click)="onClose()">
      </button>
      <button
        pButton
        type="submit"
        [label]="mode === 'create' ? ('common.create' | translate) : ('common.update' | translate)"
        [icon]="mode === 'create' ? 'pi pi-plus' : 'pi pi-check'"
        [disabled]="assetForm.invalid">
      </button>
    </div>
  </form>
</p-dialog>
