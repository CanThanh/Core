<p-dialog
  [(visible)]="visible"
  [header]="getDialogHeader()"
  [modal]="true"
  [style]="{ width: '600px' }"
  [draggable]="false"
  [resizable]="false"
  (onHide)="onClose()"
  styleClass="dialog-modern">

  <form [formGroup]="menuForm" (ngSubmit)="onSave()">
    <div class="p-fluid">
      <div class="field">
        <label for="name">{{ 'menus.menuName' | translate }} <span class="p-error">*</span></label>
        <input
          pInputText
          id="name"
          formControlName="name"
          [placeholder]="'menus.menuNamePlaceholder' | translate"
          [class.ng-invalid]="menuForm.get('name')?.invalid && menuForm.get('name')?.touched" />
        <small class="p-error" *ngIf="menuForm.get('name')?.invalid && menuForm.get('name')?.touched">
          {{ 'menus.nameRequired' | translate }}
        </small>
      </div>

      <div class="field">
        <label for="icon">{{ 'menus.icon' | translate }} (PrimeNG)</label>
        <p-dropdown
          id="icon"
          [options]="iconOptions"
          formControlName="icon"
          [placeholder]="'menus.selectIcon' | translate"
          [showClear]="true"
          optionLabel="label"
          optionValue="value"
          styleClass="w-full">
          <ng-template let-option pTemplate="item">
            <div class="flex align-items-center gap-2">
              <i [class]="option.value"></i>
              <span>{{ option.label }}</span>
            </div>
          </ng-template>
        </p-dropdown>
        <small class="text-gray-500">{{ 'menus.iconHint' | translate }}</small>
      </div>

      <div class="field">
        <label for="route">{{ 'menus.routePath' | translate }}</label>
        <input
          pInputText
          id="route"
          formControlName="route"
          [placeholder]="'menus.routePlaceholder' | translate" />
        <small class="text-gray-500">{{ 'menus.routeHint' | translate }}</small>
      </div>

      <div class="formgrid grid">
        <div class="field col-6">
          <label for="displayOrder">{{ 'menus.displayOrder' | translate }} <span class="p-error">*</span></label>
          <p-inputNumber
            id="displayOrder"
            formControlName="displayOrder"
            [min]="0"
            [showButtons]="true"
            styleClass="w-full">
          </p-inputNumber>
          <small class="text-gray-500">{{ 'menus.displayOrderHint' | translate }}</small>
        </div>

        <div class="field col-6">
          <label for="parentId">{{ 'menus.parentMenu' | translate }}</label>
          <p-dropdown
            id="parentId"
            [options]="availableParents"
            formControlName="parentId"
            [placeholder]="'menus.selectParent' | translate"
            optionLabel="label"
            optionValue="value"
            [showClear]="true"
            styleClass="w-full">
          </p-dropdown>
          <small class="text-gray-500">{{ 'menus.parentHint' | translate }}</small>
        </div>
      </div>

      <div class="field" *ngIf="mode === 'edit'">
        <label for="isActive">{{ 'common.status' | translate }}</label>
        <p-dropdown
          id="isActive"
          formControlName="isActive"
          [options]="statusOptions"
          optionLabel="label"
          optionValue="value"
          [placeholder]="'common.selectStatus' | translate"
          styleClass="w-full">
        </p-dropdown>
        <small class="text-gray-500">{{ 'menus.activeHint' | translate }}</small>
      </div>
    </div>

    <div class="flex justify-content-end gap-2 mt-4 pt-3 border-top-1 surface-border">
      <button
        pButton
        type="button"
        [label]="'common.cancel' | translate"
        class="p-button-outlined p-button-secondary"
        icon="pi pi-times"
        (click)="onClose()">
      </button>
      <button
        pButton
        type="submit"
        [label]="mode === 'create' ? ('common.create' | translate) : ('common.update' | translate)"
        [icon]="mode === 'create' ? 'pi pi-plus' : 'pi pi-check'"
        [disabled]="menuForm.invalid">
      </button>
    </div>
  </form>
</p-dialog>
