<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<div class="card">
  <div class="flex justify-content-between align-items-center mb-4">
    <h2>{{ 'roles.title' | translate }}</h2>
    <button
      pButton
      type="button"
      [label]="'roles.createRole' | translate"
      icon="pi pi-plus"
      class="p-button-success"
      (click)="openCreateDialog()">
    </button>
  </div>

  <p-table
    [value]="roles()"
    [loading]="loading()"
    responsiveLayout="scroll"
    styleClass="p-datatable-sm">

    <ng-template pTemplate="header">
      <tr>
        <th style="width: 30%">{{ 'common.name' | translate }}</th>
        <th style="width: 40%">{{ 'common.description' | translate }}</th>
        <th style="width: 10%">{{ 'common.status' | translate }}</th>
        <th style="width: 20%">{{ 'common.actions' | translate }}</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-role>
      <tr>
        <td>{{ role.name }}</td>
        <td>{{ role.description || 'N/A' }}</td>
        <td>
          <p-tag
            [value]="getStatusLabel(role.isActive)"
            [severity]="getStatusSeverity(role.isActive)">
          </p-tag>
        </td>
        <td>
          <button
            pButton
            type="button"
            icon="pi pi-key"
            class="p-button-rounded p-button-text p-button-info mr-2"
            [pTooltip]="'roles.managePermissions' | translate"
            (click)="managePermissions()">
          </button>
          <button
            pButton
            type="button"
            icon="pi pi-pencil"
            class="p-button-rounded p-button-text p-button-success mr-2"
            [pTooltip]="'common.edit' | translate"
            (click)="openEditDialog(role)">
          </button>
          <button
            pButton
            type="button"
            icon="pi pi-trash"
            class="p-button-rounded p-button-text p-button-danger"
            [pTooltip]="'common.delete' | translate"
            (click)="deleteRole(role.id, role.name)">
          </button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="text-center">{{ 'roles.noRolesFound' | translate }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<app-role-dialog
  [(visible)]="showDialog"
  [mode]="dialogMode"
  [roleId]="selectedRoleId"
  (saved)="onRoleSaved()">
</app-role-dialog>
